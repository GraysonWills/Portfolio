<div class="forgot-container">
  <div class="forgot-card">
    <h2 class="forgot-title">Reset Password</h2>

    <p class="forgot-subtitle" *ngIf="step === 'request'">
      Enter your username. We will email a verification code.
    </p>
    <p class="forgot-subtitle" *ngIf="step === 'confirm'">
      Enter the verification code from your email and your new password.
    </p>

    <form *ngIf="step === 'request'" [formGroup]="requestForm" (ngSubmit)="requestCode()" class="forgot-form">
      <div class="form-group">
        <label for="username">Username</label>
        <input
          id="username"
          type="text"
          pInputText
          formControlName="username"
          placeholder="grayson-wills">
      </div>

      <div *ngIf="errorMessage" class="error-alert">
        {{ errorMessage }}
      </div>

      <p-button
        type="submit"
        label="Send Code"
        icon="pi pi-envelope"
        [disabled]="requestForm.invalid || isSubmitting"
        [loading]="isSubmitting"
        styleClass="p-button-lg p-button-primary full-width">
      </p-button>

      <button type="button" class="link-button" (click)="backToLogin()">
        Back to login
      </button>
    </form>

    <form *ngIf="step === 'confirm'" [formGroup]="confirmForm" (ngSubmit)="confirmReset()" class="forgot-form">
      <div class="form-group">
        <label for="code">Verification Code</label>
        <input
          id="code"
          type="text"
          pInputText
          formControlName="code"
          placeholder="123456">
      </div>

      <div class="form-group">
        <label for="newPassword">New Password</label>
        <input
          id="newPassword"
          type="password"
          pInputText
          formControlName="newPassword"
          placeholder="New password">
        <small class="help-text">Minimum 12 characters, with upper/lowercase, number, and symbol.</small>
      </div>

      <div *ngIf="errorMessage" class="error-alert">
        {{ errorMessage }}
      </div>

      <p-button
        type="submit"
        label="Update Password"
        icon="pi pi-check"
        [disabled]="confirmForm.invalid || isSubmitting"
        [loading]="isSubmitting"
        styleClass="p-button-lg p-button-primary full-width">
      </p-button>

      <button type="button" class="link-button" (click)="backToLogin()">
        Back to login
      </button>
    </form>
  </div>
</div>

